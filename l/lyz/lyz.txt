サイズiにA[i]人いるとする。
このとき、条件を整理すると、ある区間であって(この区間の長さをLとする)
ceil((sum A[i])/K)>L+D-1
となるものがあるときNIE。そうでないときTAK


ceilをfloorにして、不等式が等号を含むようにずらすと、
floor({(sum A[i])+K-1}/ K)>=L+D
片方整数だからfloorを取り外せるようになって、整理すると、
sum( A[i]-K) >=K*D-K+1
となる区間があるとよくない。

したがって、数列A[i]-Kを管理しつつ、各加算クエリの後に、重み和が最大となる区間を求めるようなデータ構造があればいい。
これはセグメント木でできる。

具体的には、各ノードに、
・そのノード内での区間和の最大値
・そのノード内の和
・prefix sumの最大値
・suffix sumの最大値
を持たせる。