平方分割

gcdがB(値の最大値のsqrtの切り上げ)以下の場合は、全探索できる。
そうでないときは、答えをgとすると、g*k (k<=B)という形でそれぞれの区間に埋まっている。

したがって、k側を全探索するイメージでやる。うまいことやるとO(B)でできる。